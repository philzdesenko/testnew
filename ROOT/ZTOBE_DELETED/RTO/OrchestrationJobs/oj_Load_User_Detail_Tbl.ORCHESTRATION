{"job":{"components":{"19317":{"id":19317,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-480,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[19351],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"19318":{"id":19318,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-240,"y":32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL_LOAD_STG"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT INTO  DATA_LAKE.SERVICENOW.STG_USER_DETAILS\nSELECT parse_json($$${v_job_response}$$);"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[19356]},"19319":{"id":19319,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-368,"y":0,"width":32,"height":32,"inputConnectorIDs":[19351],"outputSuccessConnectorIDs":[19325],"outputFailureConnectorIDs":[19353],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PYT_GET_USR_DET"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print (myvar)\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print (context.getGridVariable('mygridvar'))\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\nimport requests\nimport json\nimport time\nurl = \"https://\"+v_job_tenant+\".com/api/now/table/sys_user?sysparm_query=u_employee_class=INT^u_term_dateISEMPTY^u_nick_nameISNOTEMPTY^emailISNOTEMPTY^locationISNOTEMPTY^active=true^u_guidISNOTEMPTY^u_company_codeISNOTEMPTY^u_region=AMER^u_ps_connect=true^sourceISNOTEMPTY^sourceNOTLIKEOU=Guests,DC=allegisgroup,DC=com&sysparm_display_value=true&sysparm_limit=1000&sysparm_fields=source,u_nick_name,u_company_code.u_company_code,location.name,u_guid,sys_id,u_term_date,u_start_date,state,city,country,u_department_number.description,manager.name,u_company_code.u_name,name,zip,u_physical_address,u_company_code,manager,location,u_department_number&sysparm_offset=0\"\n#url = \"https://\"+v_job_tenant+\".com/api/now/table/sys_user?sysparm_query=u_employee_class=INT%5Eu_term_dateISEMPTY%5Eu_nick_nameISNOTEMPTY%5EemailISNOTEMPTY%5ElocationISNOTEMPTY%5Eactive=true%5Eu_guidISNOTEMPTY%5Eu_company_codeISNOTEMPTY%5Eu_region=AMER%5Eu_ps_connect=true%5EsourceISNOTEMPTY%5EsourceNOTLIKEOU=Guests,DC=allegisgroup,DC=com&sysparm_display_value=true&sysparm_limit=1000&sysparm_fields=sys_id,source,u_nick_name,u_company_code.u_company_code,location.name,u_guid&sysparm_offset=0\"\n\nusername = v_job_username\npassword = v_job_password\nresponse = requests. get(url, auth=(username, password))\nkk=response.links\ngh=[]\nfn=response.text\ngh.append([fn,url])\nwhile(True):\n  url=str(kk['next']['url'])\n  response = requests.get(url, auth=(username, password))\n  fn=response.text\n  gh.append([fn,url])\n  if(str(kk['next']['url'])==str(kk['last']['url'])):\n    break\n  kk=response.links\nprint(gh)\ncontext.updateGridVariable('res_u',gh)\n\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"19320":{"id":19320,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":-112,"y":0,"width":32,"height":32,"inputConnectorIDs":[19326],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[19355],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"r_tj_Load_Reporting_Users_Tbl"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tj_Load_Reporting_Users_Tbl"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"19321":{"id":19321,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":-240,"y":0,"width":32,"height":16,"inputConnectorIDs":[19325],"outputSuccessConnectorIDs":[19326],"outputFailureConnectorIDs":[19354],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grid Iterator 0"}}}},"visible":true},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"res_u"}}}},"visible":true},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"data"},"2":{"slot":2,"type":"STRING","value":"v_job_response"}}}},"visible":true},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Concurrent"}}}},"visible":true},"7":{"slot":7,"name":"Stop on Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":false},"8":{"slot":8,"name":"Stop Condition Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":false},"9":{"slot":9,"name":"Condition","elements":{},"visible":false},"10":{"slot":10,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"11":{"slot":11,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[19356],"inputIterationConnectorIDs":[]},"19322":{"id":19322,"inputCardinality":"ZERO","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"NONE","implementationID":438858066,"x":-112,"y":128,"width":32,"height":32,"inputConnectorIDs":[19352],"outputSuccessConnectorIDs":[19327],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SNS Message"}}}},"visible":true},"2":{"slot":2,"name":"AWS Region","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us-east-1"}}}},"visible":true},"3":{"slot":3,"name":"Topic Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${v_job_sns}"}}}},"visible":true},"4":{"slot":4,"name":"Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AWS Notification Message"}}}},"visible":true},"5":{"slot":5,"name":"Message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Hi Team,\n\n${job_name} failed in project DCJ"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"19323":{"id":19323,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":-240,"y":128,"width":32,"height":32,"inputConnectorIDs":[19353,19354,19355],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[19352],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Or"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"19324":{"id":19324,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":0,"y":128,"width":32,"height":32,"inputConnectorIDs":[19327],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"19325":{"id":19325,"sourceID":19319,"targetID":19321},"19326":{"id":19326,"sourceID":19321,"targetID":19320},"19327":{"id":19327,"sourceID":19322,"targetID":19324}},"failureConnectors":{"19353":{"id":19353,"sourceID":19319,"targetID":19323},"19354":{"id":19354,"sourceID":19321,"targetID":19323},"19355":{"id":19355,"sourceID":19320,"targetID":19323}},"unconditionalConnectors":{"19351":{"id":19351,"sourceID":19317,"targetID":19319},"19352":{"id":19352,"sourceID":19323,"targetID":19322}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"19356":{"id":19356,"sourceID":19321,"targetID":19318}},"noteConnectors":{},"notes":{},"variables":{"v_job_password":{"definition":{"name":"v_job_password","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"{?2k15IOG4v;8r#EZC+{6^dCUa=kHLVgDB$];At2"},"v_job_response":{"definition":{"name":"v_job_response","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"v_job_sns":{"definition":{"name":"v_job_sns","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"RTO-Data-PROD"},"v_job_tenant":{"definition":{"name":"v_job_tenant","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"myit-dev.allegistest"},"v_job_username":{"definition":{"name":"v_job_username","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"svc.matillion"}},"grids":{"res_u":{"definition":{"name":"res_u","scope":"BRANCH","definitions":[{"name":"data","type":"TEXT"},{"name":"url","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]}}},"info":{"name":"oj_Load_User_Detail_Tbl","description":"","type":"ORCHESTRATION","tag":"1aac4604-3cd9-4c41-a49e-85f4b27fb703"}}