{"job":{"components":{"81828":{"id":81828,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1946388514,"x":-240,"y":-80,"width":32,"height":32,"inputConnectorIDs":[81836],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Success"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"81830":{"id":81830,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":356330947,"x":-800,"y":-80,"width":32,"height":32,"inputConnectorIDs":[81839],"outputSuccessConnectorIDs":[81834],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Read current metadata for target table"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_database}"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_schema}"}}}},"visible":true},"5":{"slot":5,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"existing_target_metadata"}}}},"visible":true},"6":{"slot":6,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Name"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Type"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"Size"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"Precision"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"Database Type"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Default Value"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"Not Null"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"Unique"}}}},"visible":true},"7":{"slot":7,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_table}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"81831":{"id":81831,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-1040,"y":-80,"width":32,"height":32,"inputConnectorIDs":[81838],"outputSuccessConnectorIDs":[81839],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Set fix_target_data_types"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"if schema_drift_action == 'update target':\n    fix_target_data_types = 'Y'\nelse:\n    fix_target_data_types = 'N'\n    \nprint(f'fix_target_data_types: {fix_target_data_types!r}')\ncontext.updateVariable('fix_target_data_types', fix_target_data_types)\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"81832":{"id":81832,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1877341091,"x":-400,"y":-80,"width":32,"height":32,"inputConnectorIDs":[81837],"outputSuccessConnectorIDs":[81836],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check metadata match"}}}},"visible":true},"2":{"slot":2,"name":"stage_table_metadata","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"latest_target_metadata"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"column_name"},"2":{"slot":2,"type":"GRID","value":"type"},"3":{"slot":3,"type":"GRID","value":"size"},"4":{"slot":4,"type":"GRID","value":"precision"},"5":{"slot":5,"type":"GRID","value":"database_type"}}}},"visible":true},"3":{"slot":3,"name":"target_table_metadata","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"existing_target_metadata"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"column_name"},"2":{"slot":2,"type":"GRID","value":"type"},"3":{"slot":3,"type":"GRID","value":"size"},"4":{"slot":4,"type":"GRID","value":"precision"},"5":{"slot":5,"type":"GRID","value":"database_type"}}}},"visible":true},"4":{"slot":4,"name":"target_database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_database}"}}}},"visible":true},"5":{"slot":5,"name":"target_schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_schema}"}}}},"visible":true},"6":{"slot":6,"name":"target_project","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"7":{"slot":7,"name":"target_dataset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"8":{"slot":8,"name":"target_table_name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_table}"}}}},"visible":true},"9":{"slot":9,"name":"target_platform","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Snowflake"}}}},"visible":true},"10":{"slot":10,"name":"fix_target_data_types","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${fix_target_data_types}"}}}},"visible":true},"11":{"slot":11,"name":"old_column_suffix","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"12":{"slot":12,"name":"info_messages","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"13":{"slot":13,"name":"warning_messages","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"14":{"slot":14,"name":"sql_to_execute","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"15":{"slot":15,"name":"comp_message","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"16":{"slot":16,"name":"comp_name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"81833":{"id":81833,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1200,"y":-80,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[81838],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"81835":{"id":81835,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-640,"y":-80,"width":32,"height":32,"inputConnectorIDs":[81834],"outputSuccessConnectorIDs":[81837],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Print target metadata"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"existing_target_metadata = context.getGridVariable('existing_target_metadata') or []\nprint('existing_target_metadata:')\nfor x in existing_target_metadata:\n    print(\"\\t\".join(map(str,x)))\nprint()\n\nlatest_target_metadata = context.getGridVariable('latest_target_metadata') or []\nprint('latest_target_metadata:')\nfor x in latest_target_metadata:\n    print(\"\\t\".join(map(str,x)))\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"81834":{"id":81834,"sourceID":81830,"targetID":81835},"81836":{"id":81836,"sourceID":81832,"targetID":81828},"81837":{"id":81837,"sourceID":81835,"targetID":81832},"81839":{"id":81839,"sourceID":81831,"targetID":81830}},"failureConnectors":{},"unconditionalConnectors":{"81838":{"id":81838,"sourceID":81833,"targetID":81831}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{"81826":{"id":81826,"x":-1113,"y":-235,"width":146,"height":229,"text":"**Set fix_target_data_types**\n\nUse shared job parameter __schema_drift_action__to set __fix_target_data_types__","colour":"e6e63c"},"81827":{"id":81827,"x":-874,"y":-234,"width":309,"height":229,"text":"**Read current metadata for target table**","colour":"e6e63c"},"81829":{"id":81829,"x":-474,"y":-234,"width":149,"height":228,"text":"**Check metadata match**\n\nUse shared library job to compare __latest_target_metadata__with __existing_target_metadata__\nOptionally update the target table so that it is compatible with __latest_target_metadata__","colour":"e6e63c"}},"variables":{"comp_message":{"definition":{"name":"comp_message","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"comp_name":{"definition":{"name":"comp_name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"fix_target_data_types":{"definition":{"name":"fix_target_data_types","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":"Y"},"info_messages":{"definition":{"name":"info_messages","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"old_column_suffix":{"definition":{"name":"old_column_suffix","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"rows_added":{"definition":{"name":"rows_added","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":""},"rows_removed":{"definition":{"name":"rows_removed","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":""},"schema_drift_action":{"definition":{"name":"schema_drift_action","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"sql_to_execute":{"definition":{"name":"sql_to_execute","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"target_database":{"definition":{"name":"target_database","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"target_schema":{"definition":{"name":"target_schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"target_table":{"definition":{"name":"target_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"target_table_name_full":{"definition":{"name":"target_table_name_full","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":""},"warning_messages":{"definition":{"name":"warning_messages","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""}},"grids":{"existing_target_metadata":{"definition":{"name":"existing_target_metadata","scope":"TASKBATCH","definitions":[{"name":"column_name","type":"TEXT"},{"name":"type","type":"TEXT"},{"name":"size","type":"DECIMAL"},{"name":"precision","type":"DECIMAL"},{"name":"database_type","type":"TEXT"},{"name":"default_value","type":"TEXT"},{"name":"not_null","type":"TEXT"},{"name":"unique","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"latest_target_metadata":{"definition":{"name":"latest_target_metadata","scope":"TASKBATCH","definitions":[{"name":"column_name","type":"TEXT"},{"name":"type","type":"TEXT"},{"name":"size","type":"DECIMAL"},{"name":"precision","type":"DECIMAL"},{"name":"database_type","type":"TEXT"},{"name":"default_value","type":"TEXT"},{"name":"not_null","type":"TEXT"},{"name":"unique","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["ITEM_ID","NUMBER","38","0","NUMBER(38, 0)","","No","No"]},{"values":["NAME","VARCHAR","16777216","0","VARCHAR(16777216)","","No","No"]},{"values":["COLOUR","VARCHAR","16777216","0","VARCHAR(16777216)","","No","No"]},{"values":["QUANTITY","NUMBER","38","0","NUMBER(38, 0)","","No","No"]},{"values":["LAST_ORDERED","NUMBER","38","0","NUMBER(38, 0)","","No","No"]},{"values":["MTLN_CDC_SRC_DATABASE","VARCHAR","16777216","0","VARCHAR(16777216)","","No","No"]},{"values":["MTLN_CDC_SRC_SCHEMA","VARCHAR","16777216","0","VARCHAR(16777216)","","No","No"]},{"values":["MTLN_CDC_SRC_TABLE","VARCHAR","16777216","0","VARCHAR(16777216)","","No","No"]},{"values":["MTLN_CDC_SRC_VERSION","NUMBER","38","0","NUMBER(38, 0)","","No","No"]},{"values":["MTLN_CDC_LAST_CHANGE_TYPE","VARCHAR","16777216","0","VARCHAR(16777216)","","No","No"]},{"values":["MTLN_CDC_LAST_COMMIT_TIMESTAMP","NUMBER","38","0","NUMBER(38, 0)","","No","No"]},{"values":["MTLN_CDC_PROCESSED_DATE_HOUR","TIMESTAMP","9","0","TIMESTAMP","","No","No"]},{"values":["MTLN_CDC_FILENAME","VARCHAR","16777216","0","VARCHAR(16777216)","","No","No"]},{"values":["MTLN_CDC_SEQUENCE_NUMBER","NUMBER","38","0","NUMBER(38, 0)","","No","No"]},{"values":["MTLN_CDC_LOAD_BATCH_ID","NUMBER","38","0","NUMBER(38, 0)","","No","No"]},{"values":["MTLN_CDC_LOAD_TIMESTAMP","TIMESTAMP","9","0","TIMESTAMP","","No","No"]}]}}},"info":{"name":"Sync Single Table - 1-2-3 - Resolve metadata drift","description":"Unpacked from Shared Job [Sync Single Table].","type":"ORCHESTRATION","tag":"7eddfda6-b650-454f-8030-8f2641f2484c"}}